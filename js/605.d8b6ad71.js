"use strict";(self["webpackChunk_432_hz"]=self["webpackChunk_432_hz"]||[]).push([[605],{4255:function(t,e,a){a.d(e,{Z:function(){return g}});var o=a(6252),n=a(3577),s=a(9963);const i={"aria-label":"Page navigation example"},l={class:"pagination justify-content-center"},d=(0,o._)("span",{"aria-hidden":"true"},"«",-1),p=[d],u=["onClick"],c=(0,o._)("span",{"aria-hidden":"true"},"»",-1),r=[c];function h(t,e,a,d,c,h){return(0,o.wg)(),(0,o.iD)("nav",i,[(0,o._)("ul",l,[(0,o._)("li",{class:(0,n.C_)(["page-item",{disabled:!a.pagination.has_pre}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:e[0]||(e[0]=(0,s.iM)((e=>t.$emit("getData",a.pagination.current_page-1)),["prevent"]))},p)],2),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.pagination.total_pages,(e=>((0,o.wg)(),(0,o.iD)("li",{class:(0,n.C_)(["page-item",{active:a.pagination.current_page===e}]),key:e+"page"},[(0,o._)("a",{class:"page-link",href:"#",onClick:(0,s.iM)((a=>t.$emit("getData",e)),["prevent"])},(0,n.zw)(e),9,u)],2)))),128)),(0,o._)("li",{class:(0,n.C_)(["page-item",{disabled:!a.pagination.has_next}])},[(0,o._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:e[1]||(e[1]=(0,s.iM)((e=>t.$emit("getData",a.pagination.current_page+1)),["prevent"]))},r)],2)])])}var m={props:["pagination"]},_=a(3744);const b=(0,_.Z)(m,[["render",h]]);var g=b},7903:function(t,e,a){a.d(e,{Z:function(){return i}});var o=a(7244),n={data(){return{modal:""}},methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new o.u_(this.$refs.modal)}};const s=n;var i=s},9605:function(t,e,a){a.r(e),a.d(e,{default:function(){return dt}});var o=a(6252),n=a(3577),s=a(9963);const i={class:"container"},l={class:"text-end mt-4"},d={class:"table mt-4"},p=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th",null,"名稱"),(0,o._)("th",null,"折扣百分比"),(0,o._)("th",null,"到期日"),(0,o._)("th",null,"是否啟用"),(0,o._)("th",null,"編輯")])],-1),u={class:"form-check form-switch"},c=["onUpdate:modelValue","onChange"],r={class:"form-check-label",for:"paid"},h={class:"btn-group"},m=["onClick"],_=["onClick"];function b(t,e,a,b,g,C){const v=(0,o.up)("IsLoading"),f=(0,o.up)("CouponModal"),w=(0,o.up)("delCouponModal"),y=(0,o.up)("PaginationComponent");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(v,{style:{"z-index":"1000"},active:g.isLoading},null,8,["active"]),(0,o._)("div",i,[(0,o._)("div",l,[(0,o._)("button",{class:"btn btn-primary",onClick:e[0]||(e[0]=t=>C.openModal("new"))}," 建立新的折扣券 ")]),(0,o._)("table",d,[p,(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(g.coupons,(t=>((0,o.wg)(),(0,o.iD)("tr",{key:t.id},[(0,o._)("td",null,(0,n.zw)(t.title),1),(0,o._)("td",null,(0,n.zw)(t.percent)+"%",1),(0,o._)("td",null,(0,n.zw)(new Date(1e3*t.due_date).toLocaleDateString()),1),(0,o._)("td",null,[(0,o._)("div",u,[(0,o.wy)((0,o._)("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"paid","onUpdate:modelValue":e=>t.is_enabled=e,onChange:e=>C.updateCoupon(t),"true-value":1,"false-value":0},null,40,c),[[s.e8,t.is_enabled]]),(0,o._)("label",r,[(0,o._)("span",{class:(0,n.C_)({"text-success":t.is_enabled,"text-danger":!t.is_enabled})},(0,n.zw)(t.is_enabled?"啟用":"未啟用"),3)])])]),(0,o._)("td",null,[(0,o._)("div",h,[(0,o._)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:e=>C.openModal("edit",t)}," 編輯 ",8,m),(0,o._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:e=>C.openModal("del",t)}," 刪除 ",8,_)])])])))),128))])])]),(0,o.Wm)(f,{coupons:g.tempCoupons,onUpdateCoupon:C.updateCoupon,isNew:g.isNew,"temp-coupons":g.tempCoupons,ref:"CouponModal"},null,8,["coupons","onUpdateCoupon","isNew","temp-coupons"]),(0,o.Wm)(w,{"temp-coupons":g.tempCoupons,couponId:g.couponId,onGetData:C.getData,ref:"delCouponModal"},null,8,["temp-coupons","couponId","onGetData"]),(0,o.Wm)(y,{pagination:g.pagination,onGetData:C.getData},null,8,["pagination","onGetData"])],64)}const g={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},C={class:"modal-dialog",role:"document"},v={class:"modal-content"},f={class:"modal-header"},w={class:"modal-title",id:"exampleModalLabel"},y={key:0},k={key:1},M=(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),D={class:"modal-body"},$={class:"mb-3"},x=(0,o._)("label",{for:"title"},"標題",-1),L={class:"mb-3"},N=(0,o._)("label",{for:"coupon_code"},"優惠碼",-1),S={class:"mb-3"},U={for:"due_date"},z=(0,o.Uk)("到期日 "),I={class:"mb-3"},Z=(0,o._)("label",{for:"price"},"折扣百分比",-1),P={class:"mb-3"},V={class:"form-check"},O=(0,o._)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),G={class:"modal-footer"},J=(0,o._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function W(t,e,a,i,l,d){return(0,o.wg)(),(0,o.iD)("div",g,[(0,o._)("div",C,[(0,o._)("div",v,[(0,o._)("div",f,[(0,o._)("h5",w,[a.isNew?((0,o.wg)(),(0,o.iD)("span",y,"新增優惠卷")):((0,o.wg)(),(0,o.iD)("span",k,"編輯優惠卷"))]),M]),(0,o._)("div",D,[(0,o._)("div",$,[x,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":e[0]||(e[0]=e=>t.tempCoupons.title=e)},null,512),[[s.nr,t.tempCoupons.title]])]),(0,o._)("div",L,[N,(0,o.wy)((0,o._)("input",{type:"text",class:"form-control",id:"coupon_code",placeholder:"請輸入優惠碼","onUpdate:modelValue":e[1]||(e[1]=e=>t.tempCoupons.code=e)},null,512),[[s.nr,t.tempCoupons.code]])]),(0,o._)("div",S,[(0,o._)("label",U,[z,(0,o.wy)((0,o._)("span",null,(0,n.zw)(l.due_date),513),[[s.F8,t.tempCoupons.due_date>0]])]),(0,o.wy)((0,o._)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":e[2]||(e[2]=t=>l.due_date=t)},null,512),[[s.nr,l.due_date]])]),(0,o._)("div",I,[Z,(0,o.wy)((0,o._)("input",{type:"number",class:"form-control",id:"price",min:"0",placeholder:"請輸入折扣百分比","onUpdate:modelValue":e[3]||(e[3]=e=>t.tempCoupons.percent=e)},null,512),[[s.nr,t.tempCoupons.percent,void 0,{number:!0}]])]),(0,o._)("div",P,[(0,o._)("div",V,[(0,o.wy)((0,o._)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":e[4]||(e[4]=e=>t.tempCoupons.is_enabled=e)},null,512),[[s.e8,t.tempCoupons.is_enabled]]),O])])]),(0,o._)("div",G,[J,(0,o._)("button",{type:"button",class:"btn btn-primary",onClick:e[5]||(e[5]=(...t)=>d.updateCoupon&&d.updateCoupon(...t))},(0,n.zw)(a.isNew?"新增優惠卷":"更新優惠券"),1)])])])],512)}var Y=a(7903),H={props:["coupons","isNew","temp-coupons"],data(){return{due_date:""}},methods:{updateCoupon(){this.$emit("update-coupon",this.tempCoupons)}},watch:{tempCoupons(){const t=new Date(1e3*this.tempCoupons.due_date),e=t.getFullYear();let a=t.getMonth()+1;1===a.toString().length&&(a="0"+a);let o=t.getDate();1===o.toString().length&&(o="0"+o),this.due_date=`${e}-${a}-${o}`},due_date(){this.tempCoupons.due_date=Math.floor(new Date(this.due_date)/1e3)}},mixins:[Y.Z]},F=a(3744);const K=(0,F.Z)(H,[["render",W]]);var j=K;const q={id:"delProductModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},A={class:"modal-dialog"},B={class:"modal-content border-0"},E=(0,o._)("div",{class:"modal-header bg-danger text-white"},[(0,o._)("h5",{id:"delProductModalLabel",class:"modal-title"},[(0,o._)("span",null,"刪除優惠券")]),(0,o._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Q={class:"modal-body"},R=(0,o.Uk)(" 是否刪除 "),T=(0,o._)("strong",{class:"text-danger"},null,-1),X={class:"modal-footer"},tt=(0,o._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function et(t,e,a,s,i,l){return(0,o.wg)(),(0,o.iD)("div",q,[(0,o._)("div",A,[(0,o._)("div",B,[E,(0,o._)("div",Q,[R,T,(0,o.Uk)(" "+(0,n.zw)(a.tempCoupons.title)+"(刪除後將無法恢復)。 ",1)]),(0,o._)("div",X,[tt,(0,o._)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=t=>l.delOrder())}," 確認刪除 ")])])])],512)}var at={props:["couponId","tempCoupons"],mixins:[Y.Z],data(){return{isLoading:!1}},methods:{delOrder(){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/v2/api/daikai4104/admin/coupon/${this.couponId}`;this.$http.delete(t).then((t=>{this.$httpMessageState(t,"刪除價格券"),this.isLoading=!1,this.hideModal(),this.getData()})).catch((t=>{this.$httpMessageState(t.response,"登入驗證"),this.isLoading=!1}))},getData(){this.$emit("getData")}}};const ot=(0,F.Z)(at,[["render",et]]);var nt=ot,st=a(4255),it={data(){return{coupons:[],tempCoupons:{},couponId:"",isNew:"",isLoading:!1,pagination:{}}},components:{CouponModal:j,delCouponModal:nt,PaginationComponent:st.Z},methods:{getData(t=1){this.isLoading=!0;const e=`https://vue3-course-api.hexschool.io/v2/api/daikai4104/admin/coupons?page=${t}`;this.$http.get(e).then((t=>{this.coupons=t.data.coupons,this.pagination=t.data.pagination,this.isLoading=!1})).catch((t=>{this.isLoading=!1,this.$httpMessageState(t.response,"取得資料")}))},updateCoupon(t){this.isLoading=!0;let e="https://vue3-course-api.hexschool.io/v2/api/daikai4104/admin/coupon",a="post";this.isNew||(e=`https://vue3-course-api.hexschool.io/v2/api/daikai4104/admin/coupon/${t.id}`,a="put"),this.$http[a](e,{data:t}).then((t=>{this.$httpMessageState(t,"更新狀態"),this.$refs.CouponModal.hideModal(),this.getData()})).catch((t=>{this.$httpMessageState(t.response,"更新狀態"),this.isLoading=!1}))},openModal(t,e){"new"===t?(this.tempCoupons={},this.isNew=!0,this.$refs.CouponModal.openModal()):"edit"===t?(this.tempCoupons=JSON.parse(JSON.stringify(e)),this.isNew=!1,this.$refs.CouponModal.openModal(),this.couponId=e.id):"del"===t&&(this.tempCoupons=JSON.parse(JSON.stringify(e)),this.couponId=e.id,this.$refs.delCouponModal.openModal())}},mounted(){this.getData()}};const lt=(0,F.Z)(it,[["render",b]]);var dt=lt}}]);
//# sourceMappingURL=605.d8b6ad71.js.map